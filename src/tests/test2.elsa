import "std/io";
import "std/assert";

struct MyStruct
{
	int x;

	func Get() : int
	{
		return x;
	}
	
	func Inc()
	{
		x++;
	}
};

func Test()
{
	var x = 10;

	//var f = func : int => { return x + 100; };
}

func FuncCreateInvokeTest()
{
	var f1 = func (int x) : int => { return x + 100; };
	var f2 = func (int x, int y) : int => { return x + y; };
	var f4 = func (char c) => { AssertEq('X', c); };

	AssertEq(103, f1(3));
	AssertEq(140, f2(70, 70));
	f4('X');
}

func ReturnInt() : int
{
	return 10;
}

func Funky(func : int g, func i)
{
	PrintLn(g());
	AssertEq(12, g());

	i();
	PrintLn(g());
	AssertEq(13, g());

	i();
	PrintLn(g());
	AssertEq(14, g());
}

func main()
{
	Test();
	FuncCreateInvokeTest();
	
	var str = new MyStruct { x: 10 };

	var g = str.Get;
	var i = str.Inc;
	var ri = ReturnInt;

	PrintLn(g());
	AssertEq(10, g());

	i();
	PrintLn(g());
	AssertEq(11, g());

	i();
	PrintLn(g());
	AssertEq(12, g());

	Funky(str.Get, str.Inc);
}